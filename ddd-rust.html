
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://dotmobo.xyz/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://dotmobo.xyz/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://dotmobo.xyz/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://dotmobo.xyz/theme/pygments/emacs.min.css">



  <link rel="stylesheet" type="text/css" href="https://dotmobo.xyz/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://dotmobo.xyz/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://dotmobo.xyz/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="/css/custom.css">


  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333333">



<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68852219-1', 'auto');
  ga('send', 'pageview');
</script>

 

<meta name="author" content="Morgan" />
<meta name="description" content="Domain Driven Design en Rust" />
<meta name="keywords" content="rust, ddd, domain, driven, design">


  <meta property="og:site_name" content=".mobo"/>
  <meta property="og:title" content="Domain Driven Design en Rust"/>
  <meta property="og:description" content="Domain Driven Design en Rust"/>
  <meta property="og:locale" content="fr_FR"/>
  <meta property="og:url" content="https://dotmobo.xyz/ddd-rust.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2022-12-04 00:00:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="https://dotmobo.xyz/author/morgan.html">
  <meta property="article:section" content="Rust"/>
  <meta property="article:tag" content="rust"/>
  <meta property="article:tag" content="ddd"/>
  <meta property="article:tag" content="domain"/>
  <meta property="article:tag" content="driven"/>
  <meta property="article:tag" content="design"/>
  <meta property="og:image" content="//dotmobo.github.io/images/avatar700.jpg">

  <title>.mobo &ndash; Domain Driven Design en Rust</title>


</head>
<body >

<aside>
  <div>
    <a href="https://dotmobo.xyz/">
      <img src="//dotmobo.github.io/images/avatar700.jpg" alt=".mobo" title=".mobo">
    </a>

    <h1>
      <a href="https://dotmobo.xyz/">.mobo</a>
    </h1>

    <p>Explorations d'un développeur</p>



    <ul class="social">
      <li>
        <a class="sc-github"
           href="https://github.com/dotmobo"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-twitter"
           href="https://twitter.com/dotmobo"
           target="_blank">
          <i class="fa-brands fa-twitter"></i>
        </a>
      </li>
      <li>
        <a class="sc-rss"
           href="//dotmobo.github.io/feeds/all.atom.xml"
           target="_blank">
          <i class="fa-solid fa-rss"></i>
        </a>
      </li>
    </ul>
  </div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-aside"
         data-ad-client="ca-pub-1630762128981156"
         data-ad-slot="6859931822"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</aside>
  <main>

<nav>
  <a href="https://dotmobo.xyz/">Accueil</a>

  <a href="/categories.html">Catégories</a>
  <a href="/tags.html">Tags</a>
  <a href="/archives.html">Archives</a>


</nav>

<article class="single">
  <header>
      
    <h1 id="ddd-rust">Domain Driven Design en Rust</h1>
    <p>
      Posté le 04/12/2022 dans <a href="https://dotmobo.xyz/category/rust.html">Rust</a>

    </p>
  </header>


  <div>
    <img alt="Rust" class="align-right" src="./images/rust.png" />
<div class="section" id="domain-driven-design-quesaco">
<h2>Domain Driven Design, quésaco ?</h2>
<p>Le Domain Driven Design, communément appelé DDD, est un paradigme de développement qui met l'accent sur la compréhension approfondie du domaine dans lequel ton application sera utilisée.</p>
<p>Tu peux donc imaginer des modèles de données et des algorithmes qui reflètent précisément les concepts et les relations qui existent dans ton domaine d'application.</p>
<p>Cela te permet, en théorie, de créer des logiciels plus clairs et plus faciles à comprendre pour les personnes du projet non techniques.</p>
<p>L'accent est alors mis sur la collaboration avec les experts du domaine pour obtenir leur avis et leur feedback, et permet donc de parler le même langage.</p>
</div>
<div class="section" id="ddd-en-rust">
<h2>DDD en Rust</h2>
<p>Tu dois d'abord comprendre toute la partie métier de ton appli pour pouvoir définir le domaine. Cette phase d'analyse et de compréhension est la plus importante et peut t'aider à résoudre les problèmes de manière plus efficace pour maintenir et faire évoluer ton application.</p>
<p>Ensuite, tu peux utiliser des structures en <a class="reference external" href="https://rust-lang.org/">Rust</a> pour représenter les concepts du domaine, ainsi que des fonctions pour manipuler ces structures.</p>
</div>
<div class="section" id="exemple-d-application-de-gestion-de-compte-bancaire">
<h2>Exemple d'application de gestion de compte bancaire.</h2>
<p>Voici un exemple de code en Rust qui utilise le DDD pour gérer un compte bancaire :</p>
<div class="highlight"><pre><span></span><span class="k">use</span><span class="w"> </span><span class="n">chrono</span><span class="p">::{</span><span class="n">DateTime</span><span class="p">,</span><span class="w"> </span><span class="n">Utc</span><span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Account</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">balance</span><span class="p">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">transactions</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Transaction</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">date</span><span class="p">:</span><span class="w"> </span><span class="nc">DateTime</span><span class="o">&lt;</span><span class="n">Utc</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">accounts</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">balance</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">transactions</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Transaction</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">amount</span><span class="p">,</span>
<span class="w">            </span><span class="n">date</span><span class="p">:</span><span class="w"> </span><span class="nc">Utc</span><span class="p">::</span><span class="n">now</span><span class="p">(),</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;&#39;</span><span class="nb">static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">balance</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">balance</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>
<span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">transactions</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Transaction</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">amount</span><span class="p">,</span>
<span class="w">                </span><span class="n">date</span><span class="p">:</span><span class="w"> </span><span class="nc">Utc</span><span class="p">::</span><span class="n">now</span><span class="p">(),</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&quot;Insufficient funds&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;John Doe&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">        </span><span class="n">accounts</span><span class="p">:</span><span class="w"> </span><span class="nc">vec</span><span class="o">!</span><span class="p">[</span><span class="n">Account</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">balance</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="n">transactions</span><span class="p">:</span><span class="w"> </span><span class="nc">vec</span><span class="o">!</span><span class="p">[],</span>
<span class="w">        </span><span class="p">}],</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">deposit</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">50</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">50</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<p>Ce code utilise des structures pour représenter les concepts du domaine (compte bancaire, transaction et client), ainsi que des fonctions pour manipuler ces structures (dépôt, retrait, etc.).</p>
</div>
<div class="section" id="exemple-plus-avance-un-systeme-de-gestion-de-stock">
<h2>Exemple plus avancé : un système de gestion de stock.</h2>
<p>Voici un exemple de code Rust plus avancé qui utilise le DDD pour gérer un système de gestion de stock :</p>
<div class="highlight"><pre><span></span><span class="k">use</span><span class="w"> </span><span class="n">chrono</span><span class="p">::{</span><span class="n">DateTime</span><span class="p">,</span><span class="w"> </span><span class="n">Utc</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">collections</span><span class="p">::</span><span class="n">HashMap</span><span class="p">;</span>

<span class="c1">// Représente un produit dans le stock</span>
<span class="cp">#[derive(Clone, Debug)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Nom du produit</span>
<span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Quantité en stock</span>
<span class="w">    </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Prix de vente</span>
<span class="w">    </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="kt">f32</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// Représente un client dans le système</span>
<span class="cp">#[derive(Clone, Debug)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Nom du client</span>
<span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Adresse email du client</span>
<span class="w">    </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// Représente une commande dans le système</span>
<span class="cp">#[derive(Clone, Debug)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Order</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Identifiant unique de la commande</span>
<span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Produits commandés</span>
<span class="w">    </span><span class="n">products</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Client qui a passé la commande</span>
<span class="w">    </span><span class="n">customer</span><span class="p">:</span><span class="w"> </span><span class="nc">Customer</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Date de la commande</span>
<span class="w">    </span><span class="n">date</span><span class="p">:</span><span class="w"> </span><span class="nc">DateTime</span><span class="o">&lt;</span><span class="n">Utc</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// Représente un système de gestion de stock</span>
<span class="cp">#[derive(Debug)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">StockSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Produits en stock</span>
<span class="w">    </span><span class="n">products</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">Product</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Clients enregistrés dans le système</span>
<span class="w">    </span><span class="n">customers</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">Customer</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// Commandes enregistrées dans le système</span>
<span class="w">    </span><span class="n">orders</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Order</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="w"> </span><span class="n">StockSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Ajoute un produit au stock</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add_product</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">product</span><span class="p">:</span><span class="w"> </span><span class="nc">Product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">products</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">product</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Ajoute un client au système</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add_customer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">customer</span><span class="p">:</span><span class="w"> </span><span class="nc">Customer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">customers</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="n">email</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">customer</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Passe une commande pour un client donné</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">place_order</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">products</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">customer_email</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="kt">str</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">Order</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;&#39;</span><span class="nb">static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Vérifie si les produits demandés sont en stock</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">&amp;</span><span class="n">products</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">stock_product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">products</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">stock_product</span><span class="p">.</span><span class="n">is_none</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">stock_product</span><span class="p">.</span><span class="n">unwrap</span><span class="p">().</span><span class="n">quantity</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&quot;Product out of stock&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Vérifie si le client existe dans le système</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">customers</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">customer_email</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="n">is_none</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&quot;Customer not found&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Réduit la quantité en stock pour les produits commandés</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">&amp;</span><span class="n">products</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">stock_product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">products</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="w">                </span><span class="n">stock_product</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">quantity</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Crée la commande</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">self</span><span class="p">.</span><span class="n">orders</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">u32</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="n">products</span><span class="p">,</span>
<span class="w">                </span><span class="n">customer</span><span class="p">:</span><span class="w"> </span><span class="nc">customer</span><span class="p">.</span><span class="n">unwrap</span><span class="p">().</span><span class="n">clone</span><span class="p">(),</span>
<span class="w">                </span><span class="n">date</span><span class="p">:</span><span class="w"> </span><span class="nc">Utc</span><span class="p">::</span><span class="n">now</span><span class="p">(),</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="c1">// Ajoute la commande au système</span>
<span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">orders</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">clone</span><span class="p">());</span>

<span class="w">            </span><span class="nb">Ok</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>Pour utiliser ce code, tu peux créer une instance de la structure StockSystem et ajouter des produits, des clients et passer des commandes :</p>
<div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Crée une instance du système de stock</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">stock_system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StockSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">products</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="p">::</span><span class="n">new</span><span class="p">(),</span>
<span class="w">        </span><span class="n">customers</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="p">::</span><span class="n">new</span><span class="p">(),</span>
<span class="w">        </span><span class="n">orders</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="p">::</span><span class="n">new</span><span class="p">(),</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Ajoute des produits au stock</span>
<span class="w">    </span><span class="n">stock_system</span><span class="p">.</span><span class="n">add_product</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Table&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">        </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="n">stock_system</span><span class="p">.</span><span class="n">add_product</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Chair&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">        </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Ajoute des clients au système</span>
<span class="w">    </span><span class="n">stock_system</span><span class="p">.</span><span class="n">add_customer</span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;John Doe&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">        </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;john.doe@example.com&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="n">stock_system</span><span class="p">.</span><span class="n">add_customer</span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Jane Doe&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">        </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jane.doe@example.com&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">    </span><span class="p">});</span>


<span class="w">    </span><span class="c1">// Passe une commande pour un client</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stock_system</span><span class="p">.</span><span class="n">place_order</span><span class="p">(</span><span class="fm">vec!</span><span class="p">[</span>
<span class="w">        </span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Table&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">            </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Chair&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">            </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">            </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">],</span><span class="w"> </span><span class="s">&quot;jane.doe@example.com&quot;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Order placed: {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Affiche les informations du système</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Stock system: {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">stock_system</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="avantages-et-defis">
<h2>Avantages et défis</h2>
<p>En utilisant le DDD dans tes projets, tu peux bénéficier de nombreux avantages, tels que :</p>
<ul class="simple">
<li>Des logiciels plus clairs et plus faciles à comprendre, ce qui peut améliorer la collaboration avec les autres développeurs et les experts du domaine.</li>
<li>Des modèles de données et des algorithmes qui reflètent les concepts et les relations du domaine d'application, ce qui peut améliorer la qualité de ton code et la précision de tes résultats.</li>
<li>Un code plus facile à maintenir et à évoluer, ce qui peut réduire les coûts de développement et accélérer les délais de mise sur le marché.</li>
</ul>
<p>Cependant, le DDD peut également présenter des défis, tels que :</p>
<ul class="simple">
<li>La nécessité de comprendre en profondeur le domaine d'application, ce qui peut être difficile et prendre du temps pour les développeurs qui ne sont pas des experts du domaine.</li>
<li>L'intégration du DDD dans un projet existant peut être complexe et perturbante pour le fonctionnement de l'application.</li>
<li>La mise en place d'un processus de développement orienté domaine peut nécessiter des changements importants dans la façon dont les équipes de développement travaillent, ce qui peut être difficile à gérer.</li>
</ul>
</div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://dotmobo.xyz/tag/rust.html">rust</a>
      <a href="https://dotmobo.xyz/tag/ddd.html">ddd</a>
      <a href="https://dotmobo.xyz/tag/domain.html">domain</a>
      <a href="https://dotmobo.xyz/tag/driven.html">driven</a>
      <a href="https://dotmobo.xyz/tag/design.html">design</a>
    </p>
  </div>






<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dotmobo';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Veuillez activer le JavaScript pour voir les commentaires.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>
  &copy; 2018  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Construit avec <a href="http://getpelican.com" target="_blank">Pelican</a> utilisant le thème <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a>
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://dotmobo.xyz/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " .mobo ",
  "url" : "https://dotmobo.xyz",
  "image": "//dotmobo.github.io/images/avatar700.jpg",
  "description": ".mobo - explorations d'un développeur, partage de projets, tutoriels et réflexions sur le développement."
}
</script>
</body>
</html>